import{n as k,o as f,f as S,E as b,p as B,q as M,m as l,l as V,r as N}from"./index-Dl477-pO.js";import{d as R,aU as I,s as _,r as L,w as U,ai as Y,c as $,o as q,U as t,M as s,u as r,a as m,R as O}from"./vendor-P_jj-2s_.js";import{F as H}from"./utils-BZXUrkjc.js";import{u as P}from"./use-id-transformer-41hVxyet.js";import{t as T}from"./time-CUIWP2LE.js";import"./elementPlusIcons-Ko3Z2w7D.js";var A=H();const X=R({__name:"Feed",setup(G){const p=I(),{postGet:v,preSave:c,preUpdate:w}=P(["hooks","customQueries"]),u=_(null),o=_(null),i=L(["1"]),y=async()=>{var a,e;l.success("添加成功！"),await((a=o.value)==null?void 0:a.updateDic()),await((e=o.value)==null?void 0:e.refreshChange())},D=async()=>{var a;(a=u.value)==null||a.initForm()},d=async()=>{var a,e;l.success("添加成功！"),await((a=o.value)==null?void 0:a.updateDic()),await((e=o.value)==null?void 0:e.refreshChange())},C=async()=>{try{const a=await V.api.feedExportByOpml(),e=new Blob([a],{type:"application/xml; charset=utf-8"}),n=N(`rss-impact-${T(new Date,"YYYYMMDDHHmmss")}`);A.saveAs(e,`${n}.xml`),l.success("导出成功！")}catch{l.error("导出失败！")}};return U(()=>p.path,async()=>{var a;p.path.includes("/feed")&&await((a=u.value)==null?void 0:a.updateDic())}),(a,e)=>{const n=k,E=Y("Download"),F=b,x=S,g=B;return q(),$("div",null,[t(g,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=h=>i.value=h)},{default:s(()=>[t(n,{name:"1"},{title:s(()=>e[1]||(e[1]=[m("h3",null,"快速添加订阅",-1)])),default:s(()=>[t(f,{ref_key:"crudFormDom",ref:u,url:"/feed/quickCreate","pre-submit":r(c),onSuccess:y,onResetChange:D},null,8,["pre-submit"])]),_:1}),t(n,{name:"2"},{title:s(()=>e[2]||(e[2]=[m("h3",null,"从 OPML 文件导入",-1)])),default:s(()=>[t(f,{url:"/feed/import","upload-after":d,onSuccess:d})]),_:1}),t(n,{name:"3"},{title:s(()=>e[3]||(e[3]=[m("h3",null,"导出为 OPML 文件",-1)])),default:s(()=>[t(x,{type:"primary",onClick:C},{default:s(()=>[t(F,null,{default:s(()=>[t(E)]),_:1}),e[4]||(e[4]=O(" 导出 "))]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(M,{ref_key:"crudListDom",ref:o,model:"feed",alias:"feed","post-get":r(v),"pre-save":r(c),"pre-update":r(w)},null,8,["post-get","pre-save","pre-update"])])}}});export{X as default};
//# sourceMappingURL=Feed-hxqbGtUS.js.map
