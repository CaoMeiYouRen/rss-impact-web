{"version":3,"file":"Personal-jShdYF0F.js","sources":["../../src/views/user/Personal.vue"],"sourcesContent":["<template>\n    <div>\n        <el-row :gutter=\"20\">\n            <el-col\n                :sm=\"24\"\n                :md=\"12\"\n                :lg=\"8\"\n            >\n                <CrudForm\n                    v-model=\"userForm\"\n                    method=\"POST\"\n                    url=\"/user/me\"\n                    @success=\"onSuccess\"\n                    @fail=\"onFail\"\n                />\n            </el-col>\n            <el-col\n                v-if=\"!disablePasswordLogin\"\n                :sm=\"24\"\n                :md=\"12\"\n                :lg=\"8\"\n            >\n                <CrudForm\n                    v-model=\"passwordForm\"\n                    method=\"POST\"\n                    url=\"/user/resetPassword\"\n                    @success=\"onResetPasswordSuccess\"\n                    @fail=\"onFail\"\n                />\n            </el-col>\n        </el-row>\n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, onMounted, ref } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport { useRouter } from 'vue-router'\nimport { api } from '@/api'\nimport { useAppStore } from '@/store/modules/app'\nimport { useUserStore } from '@/store/modules/user'\n\nconst router = useRouter()\nconst state = useAppStore()\nconst userStore = useUserStore()\n// 是否禁用密码登录，如果禁用了，则隐藏修改密码表单\nconst disablePasswordLogin = computed(() => Boolean(state.authMeta.disablePasswordLogin || userStore.user?.disablePasswordLogin))\n\nconst userForm = ref({})\nconst passwordForm = ref({})\n\nconst onSuccess = () => {\n    ElMessage.success('修改成功！')\n}\n\nconst onFail = () => {\n    ElMessage.error('修改失败！')\n}\n\nconst onResetPasswordSuccess = () => {\n    ElMessage.success('修改成功！即将跳转到登录页面重新登录')\n    setTimeout(async () => {\n        await router.push({\n            path: '/login',\n        })\n    }, 3000)\n}\n\nonMounted(async () => {\n    userForm.value = await api.api.userMe()\n})\n\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n"],"names":["router","useRouter","state","useAppStore","userStore","useUserStore","disablePasswordLogin","computed","userForm","ref","passwordForm","onSuccess","ElMessage","onFail","onResetPasswordSuccess","onMounted","api","_createElementBlock","_createVNode","_component_el_row","_component_el_col","_component_CrudForm","$event","_createBlock"],"mappings":"wUA0CA,MAAMA,EAASC,EAAA,EACTC,EAAQC,EAAA,EACRC,EAAYC,EAAA,EAEZC,EAAuBC,EAAS,IAAM,GAAQL,EAAM,SAAS,sBAAwBE,EAAU,MAAM,qBAAqB,EAE1HI,EAAWC,EAAI,EAAE,EACjBC,EAAeD,EAAI,EAAE,EAErBE,EAAY,IAAM,CACpBC,EAAU,QAAQ,OAAO,CAC7B,EAEMC,EAAS,IAAM,CACjBD,EAAU,MAAM,OAAO,CAC3B,EAEME,EAAyB,IAAM,CACjCF,EAAU,QAAQ,oBAAoB,EACtC,WAAW,SAAY,CACnB,MAAMZ,EAAO,KAAK,CACd,KAAM,QAAA,CACT,CACL,EAAG,GAAI,CACX,EAEA,OAAAe,EAAU,SAAY,CAClBP,EAAS,MAAQ,MAAMQ,EAAI,IAAI,OAAA,CACnC,CAAC,uCArEGC,EA8BM,MAAA,KAAA,CA7BFC,EA4BSC,EAAA,CA5BA,OAAQ,IAAE,WACf,IAYS,CAZTD,EAYSE,EAAA,CAXJ,GAAI,GACJ,GAAI,GACJ,GAAI,CAAA,aAEL,IAME,CANFF,EAMEG,EAAA,YALWb,EAAA,2CAAAA,EAAQ,MAAAc,GACjB,OAAO,OACP,IAAI,WACH,UAAAX,EACA,OAAAE,CAAA,iCAIEP,EAAA,oBADXiB,EAaSH,EAAA,OAXJ,GAAI,GACJ,GAAI,GACJ,GAAI,CAAA,aAEL,IAME,CANFF,EAMEG,EAAA,YALWX,EAAA,2CAAAA,EAAY,MAAAY,GACrB,OAAO,OACP,IAAI,sBACH,UAASR,EACT,OAAAD,CAAA"}