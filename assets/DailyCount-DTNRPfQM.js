import{B as S,w as $,d as h,e as A,C as N,f as R,E as O,D as j,q as I,A as L,l as M,m as b,_ as T}from"./index-BFV-r0LA.js";/* empty css               */import{u as U,i as q,a as z,b as P,c as Q,d as F,E as G}from"./echarts-B_AKG0OD.js";import{g as V}from"./utils-DXiOdxWP.js";import{r as x,b as B,w as H,f as J,d as K,c as W,V as a,O as n,ai as X,o as Y,a as k,S as D,k as Z,u as w}from"./vendor-CuqBZZMO.js";import"./elementPlusIcons-D10Fqe31.js";function tt(E,i,_){const f=x(),{loading:o,list:d,getOption:c,page:t,getList:y,option:g}=S(f,E,void 0,!1);t.value.pageSize=1e3;const m=$().hour(0).minute(0).second(0).millisecond(0),C=m.add(-31,"day"),r=m.add(1,"day").add(-1,"millisecond"),l=x([C.toDate(),r.toDate()]),p=B(()=>{var e;return((e=g.value.column)==null?void 0:e.filter(u=>_.includes((u==null?void 0:u.prop)||"")))||[]}),v=B(()=>({xAxis:{type:"category",data:d.value.map(e=>V(e,i))},yAxis:{type:"value"},series:p.value.map(e=>({data:d.value.map(u=>V(u,(e==null?void 0:e.prop)||"")),type:"line",name:e.label})),tooltip:{trigger:"axis"},legend:{data:p.value.map(e=>e.label),orient:"vertical",right:10,top:"center"}})),s=async()=>{const e=l.value[0],u=l.value[1];o.value=!0,await y({date:{$op:"Between",value:[e,u]}},{rawDate:"ASC",createdAt:void 0,id:void 0}),o.value=!1};return H([l],async()=>{await s()}),J(async()=>{await c(),await s()}),{loading:o,list:d,datetimerange:l,chartOption:v,onSearch:s}}const et=K({__name:"DailyCount",setup(E){U([q,z,P,Q,F]);const{datetimerange:i,chartOption:_,onSearch:f}=tt("daily-count","date",["articleCount","resourceCount","webhookLogCount","feedCount","categoryCount","hookCount","customQueryCount","proxyConfigCount","userCount"]),o=x(30);async function d(){try{await L.confirm(`确定重新统计 ${o.value} 天内的日志吗？此操作可以修复错误的统计数据，但不可回退！`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await M.api.dailyCountReCount({dayNum:o.value}),b.success("重新统计成功"),await f()}catch(c){if(console.error(c),c==="cancel")return;b.error("重新统计失败")}}return(c,t)=>{const y=N,g=X("Refresh"),m=O,C=R,r=A,l=h,p=j,v=I;return Y(),W("div",null,[a(l,{gutter:20,justify:"end"},{default:n(()=>[a(r,{sm:24,md:12,lg:8},{default:n(()=>[t[3]||(t[3]=k("label",null,"天数：",-1)),a(y,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),min:1,max:365},null,8,["modelValue"]),t[4]||(t[4]=D("   ")),a(C,{type:"warning",onClick:d},{default:n(()=>[a(m,null,{default:n(()=>[a(g)]),_:1}),t[2]||(t[2]=D("   重新统计 "))]),_:1,__:[2]})]),_:1,__:[3,4]})]),_:1}),a(l,{gutter:20},{default:n(()=>[a(r,{sm:24},{default:n(()=>[t[5]||(t[5]=k("label",null,"时间范围：",-1)),a(p,{modelValue:w(i),"onUpdate:modelValue":t[1]||(t[1]=s=>Z(i)?i.value=s:null),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1,__:[5]}),a(r,{sm:24},{default:n(()=>[a(w(G),{class:"chart",option:w(_)},null,8,["option"])]),_:1}),a(r,{sm:24},{default:n(()=>[a(v,{model:"daily-count"})]),_:1})]),_:1})])}}}),rt=T(et,[["__scopeId","data-v-6f3a90b0"]]);export{rt as default};
//# sourceMappingURL=DailyCount-DTNRPfQM.js.map
