import{n as h,o as f,f as k,E as b,p as B,q as V,m as n,l as I,r as M}from"./index-CsFvUKWI.js";import{d as N,aU as L,s as _,r as R,w as Y,am as $,c as q,o as O,I as a,J as t,u as l,a as m,S as U}from"./vendor-BLEnSRVx.js";import{G}from"./utils-CWUwXfBd.js";import{u as H}from"./use-id-transformer-C5hQerZT.js";import{t as P}from"./time-B0VzRy93.js";import"./elementPlusIcons-Bcv3OZtk.js";var T=G();const X=N({__name:"Feed",setup(A){const p=L(),{postGet:v,preSave:c,preUpdate:w}=H(["hooks","customQueries"]),r=_(null),s=_(null),i=R(["1"]),y=async()=>{n.success("添加成功！"),await s.value?.updateDic(),await s.value?.refreshChange()},D=async()=>{r.value?.initForm()},d=async()=>{n.success("添加成功！"),await s.value?.updateDic(),await s.value?.refreshChange()},C=async()=>{try{const u=await I.api.feedExportByOpml(),e=new Blob([u],{type:"application/xml; charset=utf-8"}),o=M(`rss-impact-${P(new Date,"YYYYMMDDHHmmss")}`);T.saveAs(e,`${o}.xml`),n.success("导出成功！")}catch{n.error("导出失败！")}};return Y(()=>p.path,async()=>{p.path.includes("/feed")&&await r.value?.updateDic()}),(u,e)=>{const o=h,E=$("Download"),x=b,F=k,S=B;return O(),q("div",null,[a(S,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=g=>i.value=g)},{default:t(()=>[a(o,{name:"1"},{title:t(()=>[...e[1]||(e[1]=[m("h3",null,"快速添加订阅",-1)])]),default:t(()=>[a(f,{ref_key:"crudFormDom",ref:r,url:"/feed/quickCreate","pre-submit":l(c),onSuccess:y,onResetChange:D},null,8,["pre-submit"])]),_:1}),a(o,{name:"2"},{title:t(()=>[...e[2]||(e[2]=[m("h3",null,"从 OPML 文件导入",-1)])]),default:t(()=>[a(f,{url:"/feed/import","upload-after":d,onSuccess:d})]),_:1}),a(o,{name:"3"},{title:t(()=>[...e[3]||(e[3]=[m("h3",null,"导出为 OPML 文件",-1)])]),default:t(()=>[a(F,{type:"primary",onClick:C},{default:t(()=>[a(x,null,{default:t(()=>[a(E)]),_:1}),e[4]||(e[4]=U(" 导出 ",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(V,{ref_key:"crudListDom",ref:s,model:"feed",alias:"feed","post-get":l(v),"pre-save":l(c),"pre-update":l(w)},null,8,["post-get","pre-save","pre-update"])])}}});export{X as default};
//# sourceMappingURL=Feed-CtpK2Zz6.js.map
